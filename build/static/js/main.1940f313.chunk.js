(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),o=a(52),s=a(15),l=a(14),c=a(7),h=a(6),p=a(35),u=a(5),d={roomCode:null,players:[],round:0,isInPlay:!1,responses:[],coords:{x:0,y:0,z:0},coords2:{x:0,y:0,z:0}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOM_CODE":return Object(u.a)({},e,{roomCode:t.payload});case"SET_COORDS_1":return Object(u.a)({},e,{coords:t.payload.coords});case"SET_COORDS_2":return Object(u.a)({},e,{coords2:t.payload.coords});case"ADD_PLAYER":var a=Object.assign([],e.players);return a.push(t.payload),console.log("ADDING PLAYER",a),Object(u.a)({},e,{players:a});case"START_ROUND_HOST":return Object(u.a)({},e,{responses:[],isInPlay:!0,round:e.round+1});case"SET_RESPONSES":var n=Object.assign([],e.responses).sort(function(e,t){return e.time-t.time});return n.push(t.payload),Object(u.a)({},e,{responses:n});default:return e}},y={gameIsStarted:!1,gameOver:!1},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_GAME":return Object(u.a)({},e,{gameIsStarted:!e.gameIsStarted});case"SET_GAME_OVER":return Object(u.a)({},e,{gameOver:t.payload});case"NEW_GAME":return Object(u.a)({},e,{gameIsStarted:!0});default:return e}},f={room:null,playerNumber:null},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PLAYER_ROOM":return Object(u.a)({},e,{room:t.payload});case"SET_PLAYER_NUMBER":return Object(u.a)({},e,{playerNumber:t.payload});case"SET_SELF":return Object(u.a)({},e,{self:t.payload});default:return e}},v=a(56),O=Object(c.a)(),S=[v.a,Object(l.routerMiddleware)(O)],E=h.d.apply(void 0,[h.a.apply(void 0,S)].concat([])),w=Object(h.e)((n=O,Object(h.c)({router:Object(l.connectRouter)(n),player:g,gameplay:b,host:m})),{},E),j=a(26),P=a(16),N=a(9),Y=a(10),R=a(12),D=a(11),T=a(13),k=(a(76),a(20)),C=a.n(k),I=C()("https://bping.herokuapp.com");function _(e,t){console.log("SUBSCRIBING TO PLAYER"),I.on("success-joining-room",function(e,t){console.log("success joining room",t),e.props.setPlayerRoom(t.result),e.props.setPlayerNumber(t.playerNumber)}.bind(this,e)),I.on("error-joining-room",function(){console.log("error joining room")}.bind(this)),I.on("start-round",function(e){console.log("starting round"),e.props.push("player/buzzer")}.bind(this,e)),I.on("start-game",function(e){e("startGame",!1)}.bind(this,t)),I.on("room-full",function(e){e.props.push("full")}.bind(this,e)),I.on("host-quit",function(e){e.props.push("not-found")}.bind(this,e)),I.on("restart-game",function(e){e("setGameOver",!1)}.bind(this,t)),I.on("game-over",function(e){e("setGameOver",!0)}.bind(this,t))}function X(e){console.log("EMITTING start game"),e.props.startGame(),M("start-game",e.props.room.long)}function G(e){console.log("EMITTING start game"),e.props.startGame(),M("quit-game-player",e.props.room.long)}function H(e){console.log("EMITTING restart game"),M("restart-game",e.props.room.long)}function M(e,t){I.emit(e,t)}var x=C()("https://bping.herokuapp.com");function A(e,t){console.log("SUBSCRIBING TO HOST"),x.emit("host-connected"),x.on("room-code-generated",function(e,t){console.log("setting roomcode",t),e("setRoomCode",t)}.bind(this,t)),x.on("player-joined",function(e,t){console.log("player joined",t),e("addPlayer",t)}.bind(this,t)),x.on("start-game",function(e){console.log("receiving start gaem"),e("startGame")}.bind(this,t)),x.on("player-responded",function(e,t){console.log("player response"),e.props.setResponses(t)}.bind(this,e)),x.on("device-orientation-sending",function(e,t){1===t.coords.playerNumber?e("setCoords1",t):e("setCoords2",t)}.bind(this,t)),x.on("quit-game-player",function(){window.location.reload()}.bind(this,t)),x.on("restart-game",function(e){e("setGameOver",!1)}.bind(this,t))}var W=function(e){return function(t){t({type:"SET_ROOM_CODE",payload:e})}},L=function(e){return function(t){t({type:"SET_COORDS_1",payload:e})}},B=function(e){return function(t){t({type:"SET_COORDS_2",payload:e})}},q=function(e){return function(t){t({type:"SET_RESPONSES",payload:e})}},z=function(e){return function(t){t({type:"ADD_PLAYER",payload:e})}},U=function(e){return console.log("start round host"),function(t){t({type:"START_ROUND_HOST",payload:e})}},F=function(e){return console.log("SETTING PLAYER ROOM"),function(t){t({type:"SET_PLAYER_ROOM",payload:e})}},J=function(e){return console.log("SETTING PLAYER Number"),function(t){t({type:"SET_PLAYER_NUMBER",payload:e})}},Q=function(e){return function(t){t({type:"SET_SELF",payload:e})}},V=function(e){return function(e){e({type:"START_GAME"})}},K=function(e){return function(t){t({type:"SET_GAME_OVER",payload:e})}},Z=function(e){function t(e){return Object(N.a)(this,t),Object(R.a)(this,Object(D.a)(t).call(this,e))}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.isHost?A(this,function(t,a){e.props[t](a)}):_(this,function(t,a){e.props[t](a)})}},{key:"render",value:function(){return i.a.createElement("div",null)}}]),t}(r.Component),$=Object(s.connect)(function(e){return{}},function(e){return Object(h.b)({setRoomCode:W,startGame:V,setGameOver:K,setPlayerNumber:J,setResponses:q,setCoords1:L,setCoords2:B,setSelf:Q,startRoundHost:U,addPlayer:z,setPlayerRoom:F,push:function(e){return Object(p.push)("/"+e)}},e)})(Z),ee=(a(105),function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(R.a)(this,Object(D.a)(t).call(this,e))).maxScore=7,a.ctx=null,a.playerHeight=100,a.playerWidth=7,a.playerX=20,a.playerY=window.innerHeight/2-a.playerHeight/2,a.player2X=window.innerWidth-a.playerX,a.player2Y=window.innerHeight/2-a.playerHeight/2,a.player1Score=0,a.player2Score=0,a.ballSize=5,a.ballX=window.innerWidth/2,a.ballY=window.innerHeight/2-100,a.ballDirX=1,a.ballDirY=1,a.ballYSpeed=Math.random()<.5?5:-5,a.ballXSpeed=Math.random()<.5?5:-5,a.state={player1Score:0,player2Score:0},a}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"componentWillReceiveProps",value:function(e){2!==this.props.numOfPlayers&&2===e.numOfPlayers&&(this.resetScores(),this.setup()),this.props.isGameOver&&!e.isGameOver&&this.resetScores()}},{key:"componentDidMount",value:function(){var e=this.refs.canvas.getContext("2d");this.ctx=e,this.loop()}},{key:"resetScores",value:function(){this.setState({player1Score:0,player2Score:0})}},{key:"setup",value:function(){this.ballY=window.innerHeight/2-100,this.ballX=window.innerWidth/2,this.ballYSpeed=Math.random()<.5?5:-5,this.ballXSpeed=Math.random()<.5?5:-5}},{key:"loop",value:function(){this.ctx.clearRect(0,0,window.innerWidth,window.innerHeight),this.props.isPlaying&&!this.props.isGameOver&&(this.updateBall(),this.props.is2Player&&this.updatePlayer2(),this.updatePlayer()),this.ballX<=this.playerX&&this.ballX>this.playerX-this.playerWidth?this.checkCollision():this.ballX+this.ballSize>=this.player2X&&this.ballX<this.player2X+this.playerWidth&&this.checkPlayer2Collision(),this.drawBoard(),this.drawPlayer(),this.drawBall(),window.requestAnimationFrame(this.loop.bind(this))}},{key:"drawBoard",value:function(){this.ctx.beginPath(),this.ctx.setLineDash([15,15]),this.ctx.strokeStyle="#555",this.ctx.moveTo(window.innerWidth/2,0),this.ctx.lineTo(window.innerWidth/2,window.innerHeight),this.ctx.stroke()}},{key:"score",value:function(e){}},{key:"updateBall",value:function(){var e=this;this.ballX=this.ballX+this.ballXSpeed*this.ballDirX,this.ballY=this.ballY+this.ballYSpeed*this.ballDirY,this.ballX>window.innerWidth-this.ballSize?this.props.is2Player?(this.state.player1Score+1<this.maxScore?this.setState({player1Score:this.state.player1Score+1}):this.setState({player1Score:this.state.player1Score+1},function(){e.props.gameOver()}),this.setup()):this.ballDirX*=-1:this.ballX<0&&this.props.numOfPlayers>0?(this.props.is2Player&&(this.state.player2Score+1<this.maxScore?this.setState({player2Score:this.state.player2Score+1}):this.setState({player2Score:this.state.player2Score+1},function(){e.props.gameOver()})),this.setup()):this.ballX<0&&(this.ballDirX*=-1),(this.ballY>window.innerHeight-this.ballSize||this.ballY<=0)&&(this.ballDirY*=-1)}},{key:"drawBall",value:function(){new function(e,t,a){this.x=null===e?0:e,this.y=null===t?0:t,this.r=null===a?0:a,this.draw=function(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle="#f7f7f7",e.fill()}}(this.ballX,this.ballY,this.ballSize).draw(this.ctx)}},{key:"updatePlayer",value:function(){this.playerY=this.playerY-this.props.yDir>window.innerHeight-this.playerHeight?window.innerHeight-this.playerHeight:this.playerY-this.props.yDir<=0?0:this.playerY-this.props.yDir}},{key:"updatePlayer2",value:function(){this.player2Y=this.player2Y-this.props.yDir2>window.innerHeight-this.playerHeight?window.innerHeight-this.playerHeight:this.player2Y-this.props.yDir2<=0?0:this.player2Y-this.props.yDir2}},{key:"drawPlayer",value:function(){function e(e,t,a,n){this.x=null===e?20:e,this.y=null===t?0:t,this.draw=function(r){r.rect(e,t,a,n),r.fillStyle="#f7f7f7",r.fill()}}new e(this.playerX-this.playerWidth,this.playerY,this.playerWidth,this.playerHeight).draw(this.ctx),new e(this.player2X-this.playerWidth,this.player2Y,this.playerWidth,this.playerHeight).draw(this.ctx)}},{key:"checkCollision",value:function(){var e=this.playerY,t=this.playerY+this.playerHeight/5,a=this.playerY+this.playerHeight,n=a-this.playerHeight/5;this.ballY>e&&this.ballY<a&&(this.ballDirX*=-1,this.ballDirX<0?(console.log("increassing ball speed",this.ballXSpeed),this.ballXSpeed-=1):(console.log("increassing ball speed",this.ballXSpeed),this.ballXSpeed+=1),this.ballY<t?this.ballYSpeed-=1:this.ballY>n&&(this.ballYSpeed+=1))}},{key:"checkPlayer2Collision",value:function(){var e=this.player2Y,t=this.player2Y+this.playerHeight/5,a=this.player2Y+this.playerHeight,n=a-this.playerHeight/5;this.ballY>e&&this.ballY<a&&(this.ballDirX*=-1,this.ballY<t?this.ballYSpeed-=1:this.ballY>n&&(this.ballYSpeed+=1))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("canvas",{ref:"canvas",id:"canvas",height:window.innerHeight,width:window.innerWidth}),i.a.createElement("div",{className:"scores"},this.props.numOfPlayers>1&&i.a.createElement("div",{className:"row"},i.a.createElement("p",null,this.state.player1Score),i.a.createElement("p",null,"-"),i.a.createElement("p",null,this.state.player2Score))),this.props.numOfPlayers>1&&i.a.createElement("div",{className:"button",onClick:this.resetScores.bind(this)},"Reset scores"))}}]),t}(r.Component)),te=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(R.a)(this,Object(D.a)(t).call(this,e))).timeouts=[],a.speed=1,a.state={yDir:0,yDir2:0,is2Player:!1,countdown:!1,isPlaying:!1,countdownNumber:"3"},a}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(this.state.yDir!==e.coords.y&&this.setState({yDir:e.coords.y}),this.state.yDir2!==e.coords2.y&&this.setState({yDir2:e.coords2.y,is2Player:!0}),!this.props.gameIsStarted&&e.gameIsStarted)this.startGame();else if(this.props.gameIsStarted&&!e.gameIsStarted){for(var t=0;t<this.timeouts.length;t++)clearTimeout(this.timeouts[t]);this.setState({isPlaying:!1,countdown:!1,countdownNumber:"3"})}}},{key:"startGame",value:function(){for(var e=0;e<this.timeouts.length;e++)clearTimeout(this.timeouts[e]);this.countdown("3",0,!0,0),this.countdown("2",1e3,!0,1),this.countdown("1",2e3,!0,2),this.countdown("3",3e3,!1,3)}},{key:"countdown",value:function(e,t,a,n){var r=this;this.timeouts[n]=setTimeout(function(){r.setState({countdownNumber:e,countdown:a,isPlaying:!a})},t)}},{key:"gameOver",value:function(){this.props.setGameOver(!0),x.emit("game-over")}},{key:"render",value:function(){var e,t=!1;return this.props.roomCode&&(t="https://api.qrserver.com/v1/create-qr-code/?size=250x250&data="+encodeURIComponent("http://www.pingp.co/m/"+this.props.roomCode.toLowerCase())),i.a.createElement("div",{className:"home"},i.a.createElement($,{isHost:!0}),i.a.createElement(ee,(e={isGameOver:this.props.gameOver,gameOver:this.gameOver.bind(this),isPlaying:this.props.gameIsStarted},Object(P.a)(e,"isPlaying",this.state.isPlaying),Object(P.a)(e,"yDir",this.state.yDir),Object(P.a)(e,"yDir2",this.state.yDir2),Object(P.a)(e,"is2Player",this.state.is2Player),Object(P.a)(e,"numOfPlayers",this.props.players.length),e)),i.a.createElement("div",{className:"code"},i.a.createElement("div",{className:"headerContainer"},t&&!this.props.gameIsStarted&&i.a.createElement("img",{className:"qr",src:t}),!this.props.gameIsStarted&&i.a.createElement("div",null,i.a.createElement("p",{className:"players"},"2 players, your phones are the controllers."),i.a.createElement("p",null,"Scan the QR code or go to:"),i.a.createElement("p",null,i.a.createElement("span",{className:"instructions"},"www.pingp.co/m/",this.props.roomCode?this.props.roomCode.toLowerCase():""))),this.state.countdown&&i.a.createElement("h1",{className:"qr"},this.state.countdownNumber),this.props.gameOver&&i.a.createElement("h1",{className:"qr"},"Game over"))))}}]),t}(r.Component),ae=Object(s.connect)(function(e){return{gameIsStarted:e.gameplay.gameIsStarted,roomCode:e.host.roomCode,coords:e.host.coords,coords2:e.host.coords2,players:e.host.players,gameOver:e.gameplay.gameOver}},function(e){return Object(h.b)({push:function(e){return Object(l.push)(e)},setGameOver:K},e)})(te),ne=(a(106),function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(R.a)(this,Object(D.a)(t).call(this,e))).state={xDir:0,yDir:0},a}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"componentWillMount",value:function(){var e,t,a=window.location.pathname.split("/")[2];if(a){var n={name:"",room:a.toUpperCase()};t=this,(e=n).id=I.id,t.props.setSelf(e),M("player-join-room",e)}}},{key:"componentWillReceiveProps",value:function(e){!e.playerNumber&&this.props.playerNumber&&this.props.push("not-found")}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("deviceorientation",function(t){var a,n,r=e.findLimit(t.beta);if(r!==e.state.yDir){var i={y:r,playerNumber:e.props.playerNumber};console.log("sending oritentation",r),a=i,n=e,console.log(n),n.props.room&&M("device-orientation",{room:n.props.room.long,coords:a}),e.setState({yDir:r})}})}},{key:"findLimit",value:function(e){return e<-47.5?-21:e<-42.5?-19:e<-37.5?-16:e<-32.5?-13:e<-27.5?-10:e<-22.5?-8:e<-17.5?-6:e<-12.5?-4:e<-7.5?-2:e<-2.5?-1:e<2.5?0:e<7.5?1:e<12.5?2:e<17.5?4:e<22.5?6:e<27.5?8:e<32.5?10:e<37.5?13:e<42.5?16:e<47.5?19:21}},{key:"render",value:function(){return i.a.createElement("div",{className:"mobile"},i.a.createElement($,null),!this.props.gameOver&&i.a.createElement("div",{className:"mobileInstructions"},i.a.createElement("h3",null,"Player ",JSON.stringify(this.props.playerNumber)),i.a.createElement("p",null,"Tilt phone to control paddle")),this.props.gameOver&&i.a.createElement("div",{className:"mobileInstructions"},i.a.createElement("h3",null,"Game over"),i.a.createElement("p",null,"Restart or quit game")),i.a.createElement("div",{className:"quitButtonMobile",onClick:G.bind(this,this)},i.a.createElement("h6",null,"Quit game")),!this.props.gameIsStarted&&!this.props.gameOver&&i.a.createElement("div",{className:"buttonMobile",onClick:X.bind(this,this)},i.a.createElement("h6",null,"Play")),this.props.gameIsStarted&&!this.props.gameOver&&i.a.createElement("div",{className:"buttonMobile",onClick:X.bind(this,this)},i.a.createElement("h6",null,"Pause")),this.props.gameOver&&i.a.createElement("div",{className:"buttonMobile",onClick:H.bind(this,this)},i.a.createElement("h6",null,"Restart game")))}}]),t}(r.Component)),re=Object(s.connect)(function(e){return{gameIsStarted:e.gameplay.gameIsStarted,router:e.router,room:e.player.room,playerNumber:e.player.playerNumber,gameOver:e.gameplay.gameOver}},function(e){return Object(h.b)({push:function(e){return Object(l.push)(e)},setSelf:Q,startGame:V},e)})(ne),ie=(a(107),function(e){function t(){return Object(N.a)(this,t),Object(R.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"roomFull"},i.a.createElement("h3",null,"Uh oh"),i.a.createElement("p",null,"This game is full :("))}}]),t}(r.Component)),oe=(a(108),function(e){function t(){return Object(N.a)(this,t),Object(R.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(Y.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"roomNotFound"},i.a.createElement("h3",null,"The game is over!"),i.a.createElement("p",null,"Scan the QR code to start again"))}}]),t}(r.Component)),se=function(){return i.a.createElement("div",null,i.a.createElement("main",null,i.a.createElement(j.a,{exact:!0,path:"/",component:ae}),i.a.createElement(j.a,{exact:!0,path:"/m/:code",component:re}),i.a.createElement(j.a,{exact:!0,path:"/full",component:ie}),i.a.createElement(j.a,{exact:!0,path:"/not-found",component:oe})))};a(109);Object(o.render)(i.a.createElement(s.Provider,{store:w},i.a.createElement(l.ConnectedRouter,{history:O},i.a.createElement(i.a.Fragment,null,i.a.createElement(se,null)))),document.getElementById("root"))},57:function(e,t,a){e.exports=a(110)},76:function(e,t,a){}},[[57,1,2]]]);
//# sourceMappingURL=main.1940f313.chunk.js.map